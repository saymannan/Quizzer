(function($){var supportedCSS,supportedCSSOrigin,styles=document.getElementsByTagName("head")[0].style,toCheck="transformProperty WebkitTransform OTransform msTransform MozTransform".split(" ");for(var a=0;a<toCheck.length;a++)if(styles[toCheck[a]]!==undefined){supportedCSS=toCheck[a]}if(supportedCSS){supportedCSSOrigin=supportedCSS.replace(/[tT]ransform/,"TransformOrigin");if(supportedCSSOrigin[0]=="T")supportedCSSOrigin[0]="t"}eval('IE = "v"==""');jQuery.fn.extend({rotate:function(e){if(this.length===0||typeof e=="undefined")return;if(typeof e=="number")e={angle:e};var t=[];for(var n=0,r=this.length;n<r;n++){var i=this.get(n);if(!i.Wilq32||!i.Wilq32.PhotoEffect){var s=$.extend(true,{},e);var o=(new Wilq32.PhotoEffect(i,s))._rootObj;t.push($(o))}else{i.Wilq32.PhotoEffect._handleRotation(e)}}return t},getRotateAngle:function(){var e=[];for(var t=0,n=this.length;t<n;t++){var r=this.get(t);if(r.Wilq32&&r.Wilq32.PhotoEffect){e[t]=r.Wilq32.PhotoEffect._angle}}return e},stopRotate:function(){for(var e=0,t=this.length;e<t;e++){var n=this.get(e);if(n.Wilq32&&n.Wilq32.PhotoEffect){clearTimeout(n.Wilq32.PhotoEffect._timer)}}}});Wilq32=window.Wilq32||{};Wilq32.PhotoEffect=function(){if(supportedCSS){return function(e,t){e.Wilq32={PhotoEffect:this};this._img=this._rootObj=this._eventObj=e;this._handleRotation(t)}}else{return function(e,t){this._img=e;this._onLoadDelegate=[t];this._rootObj=document.createElement("span");this._rootObj.style.display="inline-block";this._rootObj.Wilq32={PhotoEffect:this};e.parentNode.insertBefore(this._rootObj,e);if(e.complete){this._Loader()}else{var n=this;jQuery(this._img).bind("load",function(){n._Loader()})}}}}();Wilq32.PhotoEffect.prototype={_setupParameters:function(e){this._parameters=this._parameters||{};if(typeof this._angle!=="number"){this._angle=0}if(typeof e.angle==="number"){this._angle=e.angle}this._parameters.animateTo=typeof e.animateTo==="number"?e.animateTo:this._angle;this._parameters.step=e.step||this._parameters.step||null;this._parameters.easing=e.easing||this._parameters.easing||this._defaultEasing;this._parameters.duration=e.duration||this._parameters.duration||1e3;this._parameters.callback=e.callback||this._parameters.callback||this._emptyFunction;this._parameters.center=e.center||this._parameters.center||["50%","50%"];if(typeof this._parameters.center[0]=="string"){this._rotationCenterX=parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW}else{this._rotationCenterX=this._parameters.center[0]}if(typeof this._parameters.center[1]=="string"){this._rotationCenterY=parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH}else{this._rotationCenterY=this._parameters.center[1]}if(e.bind&&e.bind!=this._parameters.bind){this._BindEvents(e.bind)}},_emptyFunction:function(){},_defaultEasing:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},_handleRotation:function(e,t){if(!supportedCSS&&!this._img.complete&&!t){this._onLoadDelegate.push(e);return}this._setupParameters(e);if(this._angle==this._parameters.animateTo){this._rotate(this._angle)}else{this._animateStart()}},_BindEvents:function(e){if(e&&this._eventObj){if(this._parameters.bind){var t=this._parameters.bind;for(var n in t)if(t.hasOwnProperty(n))jQuery(this._eventObj).unbind(n,t[n])}this._parameters.bind=e;for(var n in e)if(e.hasOwnProperty(n))jQuery(this._eventObj).bind(n,e[n])}},_Loader:function(){if(IE)return function(){var e=this._img.width;var t=this._img.height;this._imgWidth=e;this._imgHeight=t;this._img.parentNode.removeChild(this._img);this._vimage=this.createVMLNode("image");this._vimage.src=this._img.src;this._vimage.style.height=t+"px";this._vimage.style.width=e+"px";this._vimage.style.position="absolute";this._vimage.style.top="0px";this._vimage.style.left="0px";this._aspectW=this._aspectH=1;this._container=this.createVMLNode("group");this._container.style.width=e;this._container.style.height=t;this._container.style.position="absolute";this._container.style.top="0px";this._container.style.left="0px";this._container.setAttribute("coordsize",e-1+","+(t-1));this._container.appendChild(this._vimage);this._rootObj.appendChild(this._container);this._rootObj.style.position="relative";this._rootObj.style.width=e+"px";this._rootObj.style.height=t+"px";this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._eventObj=this._rootObj;var n;while(n=this._onLoadDelegate.shift()){this._handleRotation(n,true)}};else return function(){this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._imgWidth=this._img.naturalWidth;this._imgHeight=this._img.naturalHeight;var e=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);this._width=e*3;this._height=e*3;this._aspectW=this._img.offsetWidth/this._img.naturalWidth;this._aspectH=this._img.offsetHeight/this._img.naturalHeight;this._img.parentNode.removeChild(this._img);this._canvas=document.createElement("canvas");this._canvas.setAttribute("width",this._width);this._canvas.style.position="relative";this._canvas.style.left=-this._img.height*this._aspectW+"px";this._canvas.style.top=-this._img.width*this._aspectH+"px";this._canvas.Wilq32=this._rootObj.Wilq32;this._rootObj.appendChild(this._canvas);this._rootObj.style.width=this._img.width*this._aspectW+"px";this._rootObj.style.height=this._img.height*this._aspectH+"px";this._eventObj=this._canvas;this._cnv=this._canvas.getContext("2d");var t;while(t=this._onLoadDelegate.shift()){this._handleRotation(t,true)}}}(),_animateStart:function(){if(this._timer){clearTimeout(this._timer)}this._animateStartTime=+(new Date);this._animateStartAngle=this._angle;this._animate()},_animate:function(){var e=+(new Date);var t=e-this._animateStartTime>this._parameters.duration;if(t&&!this._parameters.animatedGif){clearTimeout(this._timer)}else{if(this._canvas||this._vimage||this._img){var n=this._parameters.easing(0,e-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration);this._rotate(~~(n*10)/10)}if(this._parameters.step){this._parameters.step(this._angle)}var r=this;this._timer=setTimeout(function(){r._animate.call(r)},10)}if(this._parameters.callback&&t){this._angle=this._parameters.animateTo;this._rotate(this._angle);this._parameters.callback.call(this._rootObj)}},_rotate:function(){var e=Math.PI/180;if(IE)return function(e){this._angle=e;this._container.style.rotation=e%360+"deg";this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+"px";this._vimage.style.left=-(this._rotationCenterX-this._imgWidth/2)+"px";this._container.style.top=this._rotationCenterY-this._imgHeight/2+"px";this._container.style.left=this._rotationCenterX-this._imgWidth/2+"px"};else if(supportedCSS)return function(e){this._angle=e;this._img.style[supportedCSS]="rotate("+e%360+"deg)";this._img.style[supportedCSSOrigin]=this._parameters.center.join(" ")};else return function(t){this._angle=t;t=t%360*e;this._canvas.width=this._width;this._canvas.height=this._height;this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH);this._cnv.translate(this._rotationCenterX,this._rotationCenterY);this._cnv.rotate(t);this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY);this._cnv.scale(this._aspectW,this._aspectH);this._cnv.drawImage(this._img,0,0)}}()};if(IE){Wilq32.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml");return function(e){return document.createElement("<rvml:"+e+' class="rvml">')}}catch(e){return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}}()}})(jQuery)